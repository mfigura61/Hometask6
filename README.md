# Hometask6
Загрузка Linux

# Домашнее задание #
Работа с загрузчиком

Попасть в систему без пароля несколькими способами

Установить систему с LVM, после чего переименовать VG

Добавить модуль в initrd

(*). Сконфигурировать систему без отдельного раздела с /boot, а только с LVM Репозиторий с пропатченым grub: https://yum.rumyantsev.com/centos/7/x86_64/ PV необходимо инициализировать с параметром --bootloaderareasize 1m Критерии оценки: Описать действия, описать разницу между методами получения шелла в процессе загрузки. Где получится - используем script, где не получается - словами или копипастой описываем действия.

Установить систему с LVM

0. Установим систему Centos с minimal образа  на VM в VirtualBox с именем CentOS. На нем и будем экспериментировать.

## Попасть в систему без пароля несколькими способами ##

1.  Способ 1. init=/bin/sh  (См Скрин1)

Заходим в загрузчик до старта системы (перед тем, как начнется загрузка нужно успеть нажать на клашиву e - как раз когда появляется меню выбора сценариев загрузки)В конце строки, начинающейся с linux16 добавляем init=/bin/sh и нажимаем сtrl-x для загрузки в систему.Попадаем в shell без пароля.  

Приветствие: sh-4.2#
Однако, при этом рутовая файловая система при этом монтируется в режиме Read-Only. Чтобы перемонтировать ее в режим Read-Write воспользуемся командой:
sh-4.2# mount -o remount,rw /

В результате увидим:

sh-4.2# mount | grep root

/dev/mapper/centos-root on /type xfs (rw,realtime,attr2,inode64,noquota)  

2.  Способ 2. rd.break

В конце строки начинающейся с linux16 добавляем rd.break и нажимаем сtrl-x для загрузки в систему.
Попадаем в emergency mode. Наша корневая файловая система смонтирована опять же в режиме Read-Only, но мы не в ней.Выполняем команду перемонтирования корня для чтения и записи - mount -o remount,rw /sysroot, далее chroot /sysroot.  

Теперь мы можем поменять пароль, выполнив команду passwd или passwd root.

После смены пароля необходимо создать скрытый файл .autorelabel в /, выполнив touch /.autorelabel, этот файл нужен, для того чтобы выполнить relabel файлов в системе.
Делаем ребут.Загрузка произошла, теперь мы можем зайти под root, введя измененный пароль.
